# .github/workflows/ci_cd_pipeline.yml
name: Simple CI/CD Pipeline

# 1. WHEN to Run (Trigger)
# This workflow runs when code is pushed to the 'main' branch
on:
  push:
    branches: [ main ]
  # Allows you to manually trigger the workflow from the GitHub Actions tab
  workflow_dispatch:

# 2. WHAT to Run (Jobs)
jobs:
  # --- CI Stage: Build and Test ---
  build_and_test:
    runs-on: ubuntu-latest
    
    steps:
      # Step 1: Checkout the code from the repo
      - name: Checkout repository
        uses: actions/checkout@v4

      # Step 2: Set up Python environment
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.x' # Use any latest Python 3 version

      # Step 3: Install dependencies (We don't have any, but this is standard practice)
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip

      # Step 4: Run the Unit Tests (The CORE of CI)
      - name: Run tests
        run: |
          python test_calculator.py
          
  # --- CD Stage: Deployment/Approval (A simple success message for this demo) ---
  deploy:
    # This job only runs if the 'build_and_test' job succeeded
    needs: build_and_test
    runs-on: ubuntu-latest
    
    steps:
      - name: Deployment Success Message
        run: |
          echo "CI successful! Code passed all tests."
          echo "--- CONTINUOUS DEPLOYMENT (CD) STARTED ---"
          echo "Normally, this is where you'd deploy the application to a server (e.g., AWS, Azure, Heroku)."
          echo "Deployment successful for version ${{ github.sha }}!"